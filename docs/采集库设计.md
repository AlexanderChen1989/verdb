功能设计
========

-   实时数据存储
    -   存储经常改变的信息
    -   作为阈值判断的数据源
-   配置数据存储
    -   版本化存储配置更改信息
-   配件信息查询
    -   基于表达式查询配件信息
-   配件信息分析
    -   分析配件组成
    -   分析配件历史信息
-   阈值管理
    -   管理特定表的健对应的阈值
-   报警
    -   存储时检查阈值，如果超过就报警
    -   定时检查采集数据
    -   基于配置的报警信息
    -   只进行实时报警
    -   只记录最新的报警信息

模块设计
========

API设计
=======

模型设计
========

```
// 注册模型
{
      "databaseName" : "frradar",
      "collectionName" : "serverInfo",
      "name" : "frradar/serverInfo", // databaseName/collectionName
      "compareKey" : "serverId",
      "indexKeys" : [
          ["serverId"],
          ["site"]
          ...
      ],
      "verKeys" : [
          "site",
          "idc",
          "rack",
          "room",
          "cpuInfo.physicalId",
          "osInfo.kernelRelease"
          ...
      ]
  }

// 版本化存储模型
// versions: 0 -- 3 -- 5 -- 6
{'_ver': 0, '_next': 2}
{'_ver': 3, '_next': 4}
{'_ver': 5, '_next': 6, '_is_latest': true}

// 监控阈值模型
{
    'query': { 'xx.xx': 'xxx'},
    'filter': {'xxx.xxx': {'$lt': 100}},
    'msg': 'xxx.xxx小于100'
}

// 警告模型
{
  'collection': 'databaseName/collectionName',
  'document': {
    'serverId': 1000
    ...
  },

  warnings: [
    {
        'query': { 'xx.xx': 'xxx'},
        'filter': {'xxx.xxx': {'$lt': 100}},
        'msg': 'xxx.xxx小于100'
    },
    {
        'query': { 'xx.xx': 'xxx'},
        'filter': {'xxx.xxx': {'$lt': 100}},
        'msg': 'xxx.xxx小于100'
    }
  ]
}

```
